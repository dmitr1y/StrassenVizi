<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
       <link rel="icon" href="files/favicon.ico" type="image/x-icon">
       <link rel="stylesheet" type="text/css" href="styleTheory.css">
        <title>Теоритические основы алгоритма Штрассена</title>
    </head>
    <body>
        <div id="header">Умножение матриц по Штрассену</div>  
        <div class="txt">
            Пусть <i><b> A, B</b></i> — две квадратные матрицы над кольцом <i><b>R</b></i>. Матрица C получается по формуле: <br><center><b>C=A*B, где A,B &#8712; R<sup>2<sup>n</sup>x2<sup>n</sup></sup></b></center> Если размер умножаемых матриц <b>n</b> не является натуральной степенью двойки, мы дополняем исходные матрицы дополнительными нулевыми строками и столбцами. При этом мы получаем удобные для рекурсивного умножения размеры, но теряем в эффективности за счёт дополнительных ненужных умножений. <br>
            Разделим матрицы <b>A, B</b> и <b>C</b> на равные по размеру блочные матрицы: <br>
            <center><img src="matrix.png" width='300'></center>
            Для умножения матриц алгоритм Штрассена использует семь 
            формул. Эти формулы чрезвычайно неестественны и, к сожалению, в оригинальной статье 
            Штрассена не объясняется, как он пришел к ним. Замечательно, что как сами формулы, 
            так и их использование не требуют, чтобы умножение элементов матриц было коммутативным. 
            Это означает, в частности, что сами эти элементы могут быть матрицами, а значит, 
            алгоритм Штрассена можно применять рекурсивно. Вот формулы Штрассена:
        </div>
            <table border="0px"> 
          <tr>
              <td>P<sub>1</sub> = (A<sub>11</sub> + A<sub>22</sub>)*(B<sub>11</sub> 
              + B<sub>22</sub>);</td>
            <td>P<sub>5</sub> = (A<sub>11</sub> + A<sub>22</sub>)*B<sub>22</sub>;</td>
          </tr>
          <tr>
            <td>P<sub>2</sub> = (A<sub>21</sub> + A<sub>22</sub>)*B<sub>11</sub>;</td>
            <td>P<sub>6</sub> = (A<sub>21</sub> - A<sub>11</sub>)*(B<sub>11</sub>
              + B<sub>12</sub>);</td>
          </tr>
          <tr>
            <td>P<sub>3</sub> = A<sub>11</sub>*(B<sub>12</sub> 
              - B<sub>22</sub>);</td>
            <td>P<sub>7</sub> = (A<sub>21</sub> - A<sub>22</sub>)*(B<sub>21</sub>
              + B<sub>22</sub>);</td>
          </tr>
          <tr>
            <td>P<sub>4</sub> = A<sub>22</sub>*(B<sub>21</sub> 
              - B<sub>11</sub>);</td>
            <td></td>
          </tr>
            </table>
        <div class="txt">Теперь элементы матрицы <b>C</b> могут вычисляться 
            по формулам:
        </div>
        <center>
            <table border="0px">
          <tr>
            <td>C<sub>11</sub> = P<sub>1</sub> + P<sub>4</sub> 
              - P<sub>5</sub> + P<sub>7</sub>;</td>
            <td>C<sub>12</sub> = P<sub>3</sub> + P<sub>5</sub>;</td>
          </tr>
          <tr>
            <td>C<sub>21</sub> = P<sub>2</sub> + P<sub>4</sub>;</td>
            <td>C<sub>22</sub> = P<sub>1</sub> + P<sub>3</sub> 
              - P<sub>2</sub> + P<sub>6</sub>.</td>
          </tr>
            </table>
        </center>
        <div class="txt">
                При умножении двух 2х2-матриц алгоритм 
            выполняет 7 умножений и 18 сложений. Экономия не видна: мы получили 14 сложений 
            в обмен на одно умножение в стандартных алгоритмах. Анализ общего случая показывает, 
            что число умножений при перемножении двух NxN-матриц приблизительно равно N<sup>2.81</sup>, 
            а число сложений 6N<sup>2.81</sup> - 6N<sup>2</sup>. При умножении двух 16х16-матриц алгоритм Штрассена 
            экономит 1677 умножений за счет дополнительных 9138 сложений. 
            <br> <br>
        Сводя три результата воедино, мы получаем следующую картину: 
        </div>
        <center>
            <table id="compare" border="1px">
              <tr>
                  <th>
                      <div class="txt">&nbsp;</div>
                  </th>
                <th><div class="txt">Умножения</div></th>
                <th><div class="txt">Сложения</div></th>
              </tr>
              <tr>
                  <td>
                      <div class="txt">Стандартный алгоритм</div>
                  </td>
                <td><div class="txt">N<sup>3</sup></div></td>
                <td><div class="txt">N<sup>3</sup> - N<sup>2</sup></div></td>
              </tr>
              <tr>
                  <td>
                      <div class="txt">Алгоритм Штрассена</div>
                  </td>
                <td><div class="txt">N<sup>2.81</sup></div></td>
                <td><div class="txt">6N<sup>2.81</sup> - 6N<sup>2</sup></div></td>
              </tr>
            </table>
        </center>
        <div class="txt">
                На практике алгоритм Штрассена применяется 
            редко: его использование требует аккуратного отслеживания рекурсии. Важность его 
            состоит в том, что это первый алгоритм, умножение матриц с помощью которого требует 
            менее, чем N<sup>3</sup> операций. Работа над повышением эффективности матричного умножения 
            и поиском возможных нижних оценок его сложности продолжается. 
        </div>
    </body>
</html>
